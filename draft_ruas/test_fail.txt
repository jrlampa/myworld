============================= test session starts =============================
platform win32 -- Python 3.10.11, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\python.exe
cachedir: .pytest_cache
metadata: {'Python': '3.10.11', 'Platform': 'Windows-10-10.0.26200-SP0', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.12.1', 'Faker': '40.1.2', 'cov': '7.0.0', 'html': '4.2.0', 'metadata': '3.1.1', 'timeout': '2.4.0'}}
rootdir: C:\myworld\draft_ruas
plugins: anyio-4.12.1, Faker-40.1.2, cov-7.0.0, html-4.2.0, metadata-3.1.1, timeout-2.4.0
collecting ... collected 5 items

py_engine/tests/test_dxf_generator.py::test_layer_creation ERROR         [ 20%]
py_engine/tests/test_dxf_generator.py::test_block_creation ERROR         [ 40%]
py_engine/tests/test_dxf_generator.py::test_building_extrusion ERROR     [ 60%]
py_engine/tests/test_dxf_generator.py::test_add_features ERROR           [ 80%]
py_engine/tests/test_dxf_generator.py::test_legend_and_title_block ERROR [100%]

=================================== ERRORS ====================================
____________________ ERROR at setup of test_layer_creation ____________________

tmp_path = WindowsPath('C:/Users/Jonatas Lampa/AppData/Local/Temp/pytest-of-Jonatas Lampa/pytest-33/test_layer_creation0')

    @pytest.fixture
    def dxf_gen(tmp_path):
        output_file = tmp_path / "test.dxf"
>       return DXFGenerator(str(output_file))

py_engine\tests\test_dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD640EE5F0>
filename = 'C:\\Users\\Jonatas Lampa\\AppData\\Local\\Temp\\pytest-of-Jonatas Lampa\\pytest-33\\test_layer_creation0\\test.dxf'

    def __init__(self, filename):
        self.filename = filename
        self.doc = ezdxf.new('R2010')
        self.msp = self.doc.modelspace()
        self.diff_x = 0
        self.diff_y = 0
        self.bounds = None
        self.setup_styles()
        self.setup_layers()
>       self.setup_blocks()

py_engine\dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD640EE5F0>

    def setup_blocks(self):
        """Define standard blocks"""
        # Tree Block (Circle + Cross)
        if 'ARVORE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='ARVORE')
            blk.add_circle((0, 0), radius=2, dxfattribs={'layer': 'VEGETACAO', 'color': 3}) # Green
            blk.add_line((-1.5, 0), (1.5, 0), dxfattribs={'layer': 'VEGETACAO'})
            blk.add_line((0, -1.5), (0, 1.5), dxfattribs={'layer': 'VEGETACAO'})
    
        # Light/Pole Block (Square with X)
        if 'POSTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE')
            blk.add_lwpolyline([(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)], close=True, dxfattribs={'layer': 'EQUIPAMENTOS', 'color': 4})
            blk.add_line((-0.5, -0.5), (0.5, 0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            blk.add_line((-0.5, 0.5), (0.5, -0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            # Block Attributes
            blk.add_attdef('ID', (0, 1), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('TYPE', (0, 0.5), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0), dxfattribs={'height': 0.5, 'invisible': True})
    
        # bench Block (Rectangle)
        if 'BANCO' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='BANCO')
            blk.add_lwpolyline([(-1, -0.4), (1, -0.4), (1, 0.4), (-1, 0.4)], close=True, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_line((-0.8, -0.4), (-0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
            blk.add_line((0.8, -0.4), (0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # Waste Bin Block (Circle with dots)
        if 'LIXEIRA' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='LIXEIRA')
            blk.add_circle((0, 0), radius=0.4, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_circle((0, 0), radius=0.1, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
    
        # Street Lamp Block (Circle with rays)
        if 'POSTE_LUZ' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE_LUZ')
            blk.add_circle((0, 0), radius=0.3, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 2}) # Yellow
            for angle in [0, 45, 90, 135, 180, 225, 270, 315]:
                rad = np.radians(angle)
                blk.add_line((0.3*np.cos(rad), 0.3*np.sin(rad)), (0.7*np.cos(rad), 0.7*np.sin(rad)), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # High Voltage Tower Block
        if 'TORRE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='TORRE')
            # Larger square with circle
            blk.add_lwpolyline([(-2, -2), (2, -2), (2, 2), (-2, 2)], close=True, dxfattribs={'layer': 'INFRA_POWER_HV', 'color': 1})
            blk.add_line((-2, -2), (2, 2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_line((-2, 2), (2, -2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_circle((0, 0), radius=1, dxfattribs={'layer': 'INFRA_POWER_HV'})
            # Block Attributes
            blk.add_attdef('ID', (0, 2.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('TYPE', (0, 1.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0.5), dxfattribs={'height': 0.8, 'invisible': True})
    
        # North Arrow Block
        if 'NORTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='NORTE')
            # Outer circle
            blk.add_circle((0, 0), radius=5, dxfattribs={'color': 7})
            # Arrow
            blk.add_lwpolyline([(-2, -1), (0, 4), (2, -1), (0, 0)], close=True, dxfattribs={'color': 7})
            # Letter N
>           blk.add_text('N', dxfattribs={'height': 2, 'color': 7}).set_placement((0, 5.5), align=ezdxf.const.CENTER)

py_engine\dxf_generator.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <class 'ezdxf.entities.text.Text'> TEXT(#77), p1 = (0, 5.5), p2 = None
align = 1

    def set_placement(
        self,
        p1: UVec,
        p2: Optional[UVec] = None,
        align: Optional[TextEntityAlignment] = None,
    ) -> Text:
        """Set text alignment and location.
    
        The alignments :attr:`ALIGNED` and :attr:`FIT`
        are special, they require a second alignment point, the text is aligned
        on the virtual line between these two points and sits vertically at the
        baseline.
    
        - :attr:`ALIGNED`: Text is stretched or compressed
          to fit exactly between `p1` and `p2` and the text height is also
          adjusted to preserve height/width ratio.
        - :attr:`FIT`: Text is stretched or compressed to fit
          exactly between `p1` and `p2` but only the text width is adjusted,
          the text height is fixed by the :attr:`dxf.height` attribute.
        - :attr:`MIDDLE`: also a special adjustment, centered
          text like :attr:`MIDDLE_CENTER`, but vertically
          centred at the total height of the text.
    
        Args:
            p1: first alignment point as (x, y[, z])
            p2: second alignment point as (x, y[, z]), required for :attr:`ALIGNED`
                and :attr:`FIT` else ignored
            align: new alignment as enum :class:`~ezdxf.enums.TextEntityAlignment`,
                ``None`` to preserve the existing alignment.
    
        """
        if align is None:
            align = self.get_align_enum()
        else:
>           assert isinstance(align, TextEntityAlignment)
E           AssertionError

C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\entities\text.py:259: AssertionError
____________________ ERROR at setup of test_block_creation ____________________

tmp_path = WindowsPath('C:/Users/Jonatas Lampa/AppData/Local/Temp/pytest-of-Jonatas Lampa/pytest-33/test_block_creation0')

    @pytest.fixture
    def dxf_gen(tmp_path):
        output_file = tmp_path / "test.dxf"
>       return DXFGenerator(str(output_file))

py_engine\tests\test_dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD64203940>
filename = 'C:\\Users\\Jonatas Lampa\\AppData\\Local\\Temp\\pytest-of-Jonatas Lampa\\pytest-33\\test_block_creation0\\test.dxf'

    def __init__(self, filename):
        self.filename = filename
        self.doc = ezdxf.new('R2010')
        self.msp = self.doc.modelspace()
        self.diff_x = 0
        self.diff_y = 0
        self.bounds = None
        self.setup_styles()
        self.setup_layers()
>       self.setup_blocks()

py_engine\dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD64203940>

    def setup_blocks(self):
        """Define standard blocks"""
        # Tree Block (Circle + Cross)
        if 'ARVORE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='ARVORE')
            blk.add_circle((0, 0), radius=2, dxfattribs={'layer': 'VEGETACAO', 'color': 3}) # Green
            blk.add_line((-1.5, 0), (1.5, 0), dxfattribs={'layer': 'VEGETACAO'})
            blk.add_line((0, -1.5), (0, 1.5), dxfattribs={'layer': 'VEGETACAO'})
    
        # Light/Pole Block (Square with X)
        if 'POSTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE')
            blk.add_lwpolyline([(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)], close=True, dxfattribs={'layer': 'EQUIPAMENTOS', 'color': 4})
            blk.add_line((-0.5, -0.5), (0.5, 0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            blk.add_line((-0.5, 0.5), (0.5, -0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            # Block Attributes
            blk.add_attdef('ID', (0, 1), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('TYPE', (0, 0.5), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0), dxfattribs={'height': 0.5, 'invisible': True})
    
        # bench Block (Rectangle)
        if 'BANCO' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='BANCO')
            blk.add_lwpolyline([(-1, -0.4), (1, -0.4), (1, 0.4), (-1, 0.4)], close=True, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_line((-0.8, -0.4), (-0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
            blk.add_line((0.8, -0.4), (0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # Waste Bin Block (Circle with dots)
        if 'LIXEIRA' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='LIXEIRA')
            blk.add_circle((0, 0), radius=0.4, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_circle((0, 0), radius=0.1, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
    
        # Street Lamp Block (Circle with rays)
        if 'POSTE_LUZ' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE_LUZ')
            blk.add_circle((0, 0), radius=0.3, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 2}) # Yellow
            for angle in [0, 45, 90, 135, 180, 225, 270, 315]:
                rad = np.radians(angle)
                blk.add_line((0.3*np.cos(rad), 0.3*np.sin(rad)), (0.7*np.cos(rad), 0.7*np.sin(rad)), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # High Voltage Tower Block
        if 'TORRE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='TORRE')
            # Larger square with circle
            blk.add_lwpolyline([(-2, -2), (2, -2), (2, 2), (-2, 2)], close=True, dxfattribs={'layer': 'INFRA_POWER_HV', 'color': 1})
            blk.add_line((-2, -2), (2, 2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_line((-2, 2), (2, -2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_circle((0, 0), radius=1, dxfattribs={'layer': 'INFRA_POWER_HV'})
            # Block Attributes
            blk.add_attdef('ID', (0, 2.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('TYPE', (0, 1.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0.5), dxfattribs={'height': 0.8, 'invisible': True})
    
        # North Arrow Block
        if 'NORTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='NORTE')
            # Outer circle
            blk.add_circle((0, 0), radius=5, dxfattribs={'color': 7})
            # Arrow
            blk.add_lwpolyline([(-2, -1), (0, 4), (2, -1), (0, 0)], close=True, dxfattribs={'color': 7})
            # Letter N
>           blk.add_text('N', dxfattribs={'height': 2, 'color': 7}).set_placement((0, 5.5), align=ezdxf.const.CENTER)

py_engine\dxf_generator.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <class 'ezdxf.entities.text.Text'> TEXT(#77), p1 = (0, 5.5), p2 = None
align = 1

    def set_placement(
        self,
        p1: UVec,
        p2: Optional[UVec] = None,
        align: Optional[TextEntityAlignment] = None,
    ) -> Text:
        """Set text alignment and location.
    
        The alignments :attr:`ALIGNED` and :attr:`FIT`
        are special, they require a second alignment point, the text is aligned
        on the virtual line between these two points and sits vertically at the
        baseline.
    
        - :attr:`ALIGNED`: Text is stretched or compressed
          to fit exactly between `p1` and `p2` and the text height is also
          adjusted to preserve height/width ratio.
        - :attr:`FIT`: Text is stretched or compressed to fit
          exactly between `p1` and `p2` but only the text width is adjusted,
          the text height is fixed by the :attr:`dxf.height` attribute.
        - :attr:`MIDDLE`: also a special adjustment, centered
          text like :attr:`MIDDLE_CENTER`, but vertically
          centred at the total height of the text.
    
        Args:
            p1: first alignment point as (x, y[, z])
            p2: second alignment point as (x, y[, z]), required for :attr:`ALIGNED`
                and :attr:`FIT` else ignored
            align: new alignment as enum :class:`~ezdxf.enums.TextEntityAlignment`,
                ``None`` to preserve the existing alignment.
    
        """
        if align is None:
            align = self.get_align_enum()
        else:
>           assert isinstance(align, TextEntityAlignment)
E           AssertionError

C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\entities\text.py:259: AssertionError
__________________ ERROR at setup of test_building_extrusion __________________

tmp_path = WindowsPath('C:/Users/Jonatas Lampa/AppData/Local/Temp/pytest-of-Jonatas Lampa/pytest-33/test_building_extrusion0')

    @pytest.fixture
    def dxf_gen(tmp_path):
        output_file = tmp_path / "test.dxf"
>       return DXFGenerator(str(output_file))

py_engine\tests\test_dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD643FBA00>
filename = 'C:\\Users\\Jonatas Lampa\\AppData\\Local\\Temp\\pytest-of-Jonatas Lampa\\pytest-33\\test_building_extrusion0\\test.dxf'

    def __init__(self, filename):
        self.filename = filename
        self.doc = ezdxf.new('R2010')
        self.msp = self.doc.modelspace()
        self.diff_x = 0
        self.diff_y = 0
        self.bounds = None
        self.setup_styles()
        self.setup_layers()
>       self.setup_blocks()

py_engine\dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD643FBA00>

    def setup_blocks(self):
        """Define standard blocks"""
        # Tree Block (Circle + Cross)
        if 'ARVORE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='ARVORE')
            blk.add_circle((0, 0), radius=2, dxfattribs={'layer': 'VEGETACAO', 'color': 3}) # Green
            blk.add_line((-1.5, 0), (1.5, 0), dxfattribs={'layer': 'VEGETACAO'})
            blk.add_line((0, -1.5), (0, 1.5), dxfattribs={'layer': 'VEGETACAO'})
    
        # Light/Pole Block (Square with X)
        if 'POSTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE')
            blk.add_lwpolyline([(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)], close=True, dxfattribs={'layer': 'EQUIPAMENTOS', 'color': 4})
            blk.add_line((-0.5, -0.5), (0.5, 0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            blk.add_line((-0.5, 0.5), (0.5, -0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            # Block Attributes
            blk.add_attdef('ID', (0, 1), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('TYPE', (0, 0.5), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0), dxfattribs={'height': 0.5, 'invisible': True})
    
        # bench Block (Rectangle)
        if 'BANCO' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='BANCO')
            blk.add_lwpolyline([(-1, -0.4), (1, -0.4), (1, 0.4), (-1, 0.4)], close=True, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_line((-0.8, -0.4), (-0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
            blk.add_line((0.8, -0.4), (0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # Waste Bin Block (Circle with dots)
        if 'LIXEIRA' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='LIXEIRA')
            blk.add_circle((0, 0), radius=0.4, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_circle((0, 0), radius=0.1, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
    
        # Street Lamp Block (Circle with rays)
        if 'POSTE_LUZ' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE_LUZ')
            blk.add_circle((0, 0), radius=0.3, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 2}) # Yellow
            for angle in [0, 45, 90, 135, 180, 225, 270, 315]:
                rad = np.radians(angle)
                blk.add_line((0.3*np.cos(rad), 0.3*np.sin(rad)), (0.7*np.cos(rad), 0.7*np.sin(rad)), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # High Voltage Tower Block
        if 'TORRE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='TORRE')
            # Larger square with circle
            blk.add_lwpolyline([(-2, -2), (2, -2), (2, 2), (-2, 2)], close=True, dxfattribs={'layer': 'INFRA_POWER_HV', 'color': 1})
            blk.add_line((-2, -2), (2, 2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_line((-2, 2), (2, -2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_circle((0, 0), radius=1, dxfattribs={'layer': 'INFRA_POWER_HV'})
            # Block Attributes
            blk.add_attdef('ID', (0, 2.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('TYPE', (0, 1.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0.5), dxfattribs={'height': 0.8, 'invisible': True})
    
        # North Arrow Block
        if 'NORTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='NORTE')
            # Outer circle
            blk.add_circle((0, 0), radius=5, dxfattribs={'color': 7})
            # Arrow
            blk.add_lwpolyline([(-2, -1), (0, 4), (2, -1), (0, 0)], close=True, dxfattribs={'color': 7})
            # Letter N
>           blk.add_text('N', dxfattribs={'height': 2, 'color': 7}).set_placement((0, 5.5), align=ezdxf.const.CENTER)

py_engine\dxf_generator.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <class 'ezdxf.entities.text.Text'> TEXT(#77), p1 = (0, 5.5), p2 = None
align = 1

    def set_placement(
        self,
        p1: UVec,
        p2: Optional[UVec] = None,
        align: Optional[TextEntityAlignment] = None,
    ) -> Text:
        """Set text alignment and location.
    
        The alignments :attr:`ALIGNED` and :attr:`FIT`
        are special, they require a second alignment point, the text is aligned
        on the virtual line between these two points and sits vertically at the
        baseline.
    
        - :attr:`ALIGNED`: Text is stretched or compressed
          to fit exactly between `p1` and `p2` and the text height is also
          adjusted to preserve height/width ratio.
        - :attr:`FIT`: Text is stretched or compressed to fit
          exactly between `p1` and `p2` but only the text width is adjusted,
          the text height is fixed by the :attr:`dxf.height` attribute.
        - :attr:`MIDDLE`: also a special adjustment, centered
          text like :attr:`MIDDLE_CENTER`, but vertically
          centred at the total height of the text.
    
        Args:
            p1: first alignment point as (x, y[, z])
            p2: second alignment point as (x, y[, z]), required for :attr:`ALIGNED`
                and :attr:`FIT` else ignored
            align: new alignment as enum :class:`~ezdxf.enums.TextEntityAlignment`,
                ``None`` to preserve the existing alignment.
    
        """
        if align is None:
            align = self.get_align_enum()
        else:
>           assert isinstance(align, TextEntityAlignment)
E           AssertionError

C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\entities\text.py:259: AssertionError
_____________________ ERROR at setup of test_add_features _____________________

tmp_path = WindowsPath('C:/Users/Jonatas Lampa/AppData/Local/Temp/pytest-of-Jonatas Lampa/pytest-33/test_add_features0')

    @pytest.fixture
    def dxf_gen(tmp_path):
        output_file = tmp_path / "test.dxf"
>       return DXFGenerator(str(output_file))

py_engine\tests\test_dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD64348A90>
filename = 'C:\\Users\\Jonatas Lampa\\AppData\\Local\\Temp\\pytest-of-Jonatas Lampa\\pytest-33\\test_add_features0\\test.dxf'

    def __init__(self, filename):
        self.filename = filename
        self.doc = ezdxf.new('R2010')
        self.msp = self.doc.modelspace()
        self.diff_x = 0
        self.diff_y = 0
        self.bounds = None
        self.setup_styles()
        self.setup_layers()
>       self.setup_blocks()

py_engine\dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD64348A90>

    def setup_blocks(self):
        """Define standard blocks"""
        # Tree Block (Circle + Cross)
        if 'ARVORE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='ARVORE')
            blk.add_circle((0, 0), radius=2, dxfattribs={'layer': 'VEGETACAO', 'color': 3}) # Green
            blk.add_line((-1.5, 0), (1.5, 0), dxfattribs={'layer': 'VEGETACAO'})
            blk.add_line((0, -1.5), (0, 1.5), dxfattribs={'layer': 'VEGETACAO'})
    
        # Light/Pole Block (Square with X)
        if 'POSTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE')
            blk.add_lwpolyline([(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)], close=True, dxfattribs={'layer': 'EQUIPAMENTOS', 'color': 4})
            blk.add_line((-0.5, -0.5), (0.5, 0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            blk.add_line((-0.5, 0.5), (0.5, -0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            # Block Attributes
            blk.add_attdef('ID', (0, 1), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('TYPE', (0, 0.5), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0), dxfattribs={'height': 0.5, 'invisible': True})
    
        # bench Block (Rectangle)
        if 'BANCO' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='BANCO')
            blk.add_lwpolyline([(-1, -0.4), (1, -0.4), (1, 0.4), (-1, 0.4)], close=True, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_line((-0.8, -0.4), (-0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
            blk.add_line((0.8, -0.4), (0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # Waste Bin Block (Circle with dots)
        if 'LIXEIRA' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='LIXEIRA')
            blk.add_circle((0, 0), radius=0.4, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_circle((0, 0), radius=0.1, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
    
        # Street Lamp Block (Circle with rays)
        if 'POSTE_LUZ' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE_LUZ')
            blk.add_circle((0, 0), radius=0.3, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 2}) # Yellow
            for angle in [0, 45, 90, 135, 180, 225, 270, 315]:
                rad = np.radians(angle)
                blk.add_line((0.3*np.cos(rad), 0.3*np.sin(rad)), (0.7*np.cos(rad), 0.7*np.sin(rad)), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # High Voltage Tower Block
        if 'TORRE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='TORRE')
            # Larger square with circle
            blk.add_lwpolyline([(-2, -2), (2, -2), (2, 2), (-2, 2)], close=True, dxfattribs={'layer': 'INFRA_POWER_HV', 'color': 1})
            blk.add_line((-2, -2), (2, 2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_line((-2, 2), (2, -2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_circle((0, 0), radius=1, dxfattribs={'layer': 'INFRA_POWER_HV'})
            # Block Attributes
            blk.add_attdef('ID', (0, 2.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('TYPE', (0, 1.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0.5), dxfattribs={'height': 0.8, 'invisible': True})
    
        # North Arrow Block
        if 'NORTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='NORTE')
            # Outer circle
            blk.add_circle((0, 0), radius=5, dxfattribs={'color': 7})
            # Arrow
            blk.add_lwpolyline([(-2, -1), (0, 4), (2, -1), (0, 0)], close=True, dxfattribs={'color': 7})
            # Letter N
>           blk.add_text('N', dxfattribs={'height': 2, 'color': 7}).set_placement((0, 5.5), align=ezdxf.const.CENTER)

py_engine\dxf_generator.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <class 'ezdxf.entities.text.Text'> TEXT(#77), p1 = (0, 5.5), p2 = None
align = 1

    def set_placement(
        self,
        p1: UVec,
        p2: Optional[UVec] = None,
        align: Optional[TextEntityAlignment] = None,
    ) -> Text:
        """Set text alignment and location.
    
        The alignments :attr:`ALIGNED` and :attr:`FIT`
        are special, they require a second alignment point, the text is aligned
        on the virtual line between these two points and sits vertically at the
        baseline.
    
        - :attr:`ALIGNED`: Text is stretched or compressed
          to fit exactly between `p1` and `p2` and the text height is also
          adjusted to preserve height/width ratio.
        - :attr:`FIT`: Text is stretched or compressed to fit
          exactly between `p1` and `p2` but only the text width is adjusted,
          the text height is fixed by the :attr:`dxf.height` attribute.
        - :attr:`MIDDLE`: also a special adjustment, centered
          text like :attr:`MIDDLE_CENTER`, but vertically
          centred at the total height of the text.
    
        Args:
            p1: first alignment point as (x, y[, z])
            p2: second alignment point as (x, y[, z]), required for :attr:`ALIGNED`
                and :attr:`FIT` else ignored
            align: new alignment as enum :class:`~ezdxf.enums.TextEntityAlignment`,
                ``None`` to preserve the existing alignment.
    
        """
        if align is None:
            align = self.get_align_enum()
        else:
>           assert isinstance(align, TextEntityAlignment)
E           AssertionError

C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\entities\text.py:259: AssertionError
________________ ERROR at setup of test_legend_and_title_block ________________

tmp_path = WindowsPath('C:/Users/Jonatas Lampa/AppData/Local/Temp/pytest-of-Jonatas Lampa/pytest-33/test_legend_and_title_block0')

    @pytest.fixture
    def dxf_gen(tmp_path):
        output_file = tmp_path / "test.dxf"
>       return DXFGenerator(str(output_file))

py_engine\tests\test_dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD6432E320>
filename = 'C:\\Users\\Jonatas Lampa\\AppData\\Local\\Temp\\pytest-of-Jonatas Lampa\\pytest-33\\test_legend_and_title_block0\\test.dxf'

    def __init__(self, filename):
        self.filename = filename
        self.doc = ezdxf.new('R2010')
        self.msp = self.doc.modelspace()
        self.diff_x = 0
        self.diff_y = 0
        self.bounds = None
        self.setup_styles()
        self.setup_layers()
>       self.setup_blocks()

py_engine\dxf_generator.py:17: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <dxf_generator.DXFGenerator object at 0x000001AD6432E320>

    def setup_blocks(self):
        """Define standard blocks"""
        # Tree Block (Circle + Cross)
        if 'ARVORE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='ARVORE')
            blk.add_circle((0, 0), radius=2, dxfattribs={'layer': 'VEGETACAO', 'color': 3}) # Green
            blk.add_line((-1.5, 0), (1.5, 0), dxfattribs={'layer': 'VEGETACAO'})
            blk.add_line((0, -1.5), (0, 1.5), dxfattribs={'layer': 'VEGETACAO'})
    
        # Light/Pole Block (Square with X)
        if 'POSTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE')
            blk.add_lwpolyline([(-0.5, -0.5), (0.5, -0.5), (0.5, 0.5), (-0.5, 0.5)], close=True, dxfattribs={'layer': 'EQUIPAMENTOS', 'color': 4})
            blk.add_line((-0.5, -0.5), (0.5, 0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            blk.add_line((-0.5, 0.5), (0.5, -0.5), dxfattribs={'layer': 'EQUIPAMENTOS'})
            # Block Attributes
            blk.add_attdef('ID', (0, 1), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('TYPE', (0, 0.5), dxfattribs={'height': 0.5, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0), dxfattribs={'height': 0.5, 'invisible': True})
    
        # bench Block (Rectangle)
        if 'BANCO' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='BANCO')
            blk.add_lwpolyline([(-1, -0.4), (1, -0.4), (1, 0.4), (-1, 0.4)], close=True, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_line((-0.8, -0.4), (-0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
            blk.add_line((0.8, -0.4), (0.8, 0.4), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # Waste Bin Block (Circle with dots)
        if 'LIXEIRA' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='LIXEIRA')
            blk.add_circle((0, 0), radius=0.4, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
            blk.add_circle((0, 0), radius=0.1, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 40})
    
        # Street Lamp Block (Circle with rays)
        if 'POSTE_LUZ' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='POSTE_LUZ')
            blk.add_circle((0, 0), radius=0.3, dxfattribs={'layer': 'MOBILIARIO_URBANO', 'color': 2}) # Yellow
            for angle in [0, 45, 90, 135, 180, 225, 270, 315]:
                rad = np.radians(angle)
                blk.add_line((0.3*np.cos(rad), 0.3*np.sin(rad)), (0.7*np.cos(rad), 0.7*np.sin(rad)), dxfattribs={'layer': 'MOBILIARIO_URBANO'})
    
        # High Voltage Tower Block
        if 'TORRE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='TORRE')
            # Larger square with circle
            blk.add_lwpolyline([(-2, -2), (2, -2), (2, 2), (-2, 2)], close=True, dxfattribs={'layer': 'INFRA_POWER_HV', 'color': 1})
            blk.add_line((-2, -2), (2, 2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_line((-2, 2), (2, -2), dxfattribs={'layer': 'INFRA_POWER_HV'})
            blk.add_circle((0, 0), radius=1, dxfattribs={'layer': 'INFRA_POWER_HV'})
            # Block Attributes
            blk.add_attdef('ID', (0, 2.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('TYPE', (0, 1.5), dxfattribs={'height': 0.8, 'invisible': True})
            blk.add_attdef('V_LEVEL', (0, 0.5), dxfattribs={'height': 0.8, 'invisible': True})
    
        # North Arrow Block
        if 'NORTE' not in self.doc.blocks:
            blk = self.doc.blocks.new(name='NORTE')
            # Outer circle
            blk.add_circle((0, 0), radius=5, dxfattribs={'color': 7})
            # Arrow
            blk.add_lwpolyline([(-2, -1), (0, 4), (2, -1), (0, 0)], close=True, dxfattribs={'color': 7})
            # Letter N
>           blk.add_text('N', dxfattribs={'height': 2, 'color': 7}).set_placement((0, 5.5), align=ezdxf.const.CENTER)

py_engine\dxf_generator.py:94: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <class 'ezdxf.entities.text.Text'> TEXT(#77), p1 = (0, 5.5), p2 = None
align = 1

    def set_placement(
        self,
        p1: UVec,
        p2: Optional[UVec] = None,
        align: Optional[TextEntityAlignment] = None,
    ) -> Text:
        """Set text alignment and location.
    
        The alignments :attr:`ALIGNED` and :attr:`FIT`
        are special, they require a second alignment point, the text is aligned
        on the virtual line between these two points and sits vertically at the
        baseline.
    
        - :attr:`ALIGNED`: Text is stretched or compressed
          to fit exactly between `p1` and `p2` and the text height is also
          adjusted to preserve height/width ratio.
        - :attr:`FIT`: Text is stretched or compressed to fit
          exactly between `p1` and `p2` but only the text width is adjusted,
          the text height is fixed by the :attr:`dxf.height` attribute.
        - :attr:`MIDDLE`: also a special adjustment, centered
          text like :attr:`MIDDLE_CENTER`, but vertically
          centred at the total height of the text.
    
        Args:
            p1: first alignment point as (x, y[, z])
            p2: second alignment point as (x, y[, z]), required for :attr:`ALIGNED`
                and :attr:`FIT` else ignored
            align: new alignment as enum :class:`~ezdxf.enums.TextEntityAlignment`,
                ``None`` to preserve the existing alignment.
    
        """
        if align is None:
            align = self.get_align_enum()
        else:
>           assert isinstance(align, TextEntityAlignment)
E           AssertionError

C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\entities\text.py:259: AssertionError
============================== warnings summary ===============================
..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:50
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:50: PyparsingDeprecationWarning: 'addParseAction' deprecated - use 'add_parse_action'
    number.addParseAction(lambda t: float(t[0]))  # convert to float

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:51
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:51: PyparsingDeprecationWarning: 'addParseAction' deprecated - use 'add_parse_action'
    string_ = quotedString.addParseAction(lambda t: t[0][1:-1])  # remove quotes

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:57
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:57: PyparsingDeprecationWarning: 'oneOf' deprecated - use 'one_of'
    Relation = oneOf(["==", "!=", "<", "<=", ">", ">=", "?", "!?"])

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:63
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:63: PyparsingDeprecationWarning: 'setResultsName' deprecated - use 'set_results_name'
    ).setResultsName("EntityQuery")

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:65
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:65: PyparsingDeprecationWarning: 'infixNotation' deprecated - use 'infix_notation'
    InfixBoolQuery = infixNotation(

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:72
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:72: PyparsingDeprecationWarning: 'setResultsName' deprecated - use 'set_results_name'
    ).setResultsName("AttribQuery")

..\..\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:74
  C:\Users\Jonatas Lampa\AppData\Local\Programs\Python\Python310\lib\site-packages\ezdxf\queryparser.py:74: PyparsingDeprecationWarning: 'setResultsName' deprecated - use 'set_results_name'
    AttribQueryOptions = Literal("i").setResultsName("AttribQueryOptions")

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
ERROR py_engine/tests/test_dxf_generator.py::test_layer_creation - AssertionE...
ERROR py_engine/tests/test_dxf_generator.py::test_block_creation - AssertionE...
ERROR py_engine/tests/test_dxf_generator.py::test_building_extrusion - Assert...
ERROR py_engine/tests/test_dxf_generator.py::test_add_features - AssertionError
ERROR py_engine/tests/test_dxf_generator.py::test_legend_and_title_block - As...
======================== 7 warnings, 5 errors in 1.43s ========================
