# ============================================
# SIS RUA Unified - Environment Configuration
# ============================================

# --------------------------------------------
# Server Configuration
# --------------------------------------------
NODE_ENV=development
PORT=8080

# --------------------------------------------
# Frontend API Configuration (Optional)
# --------------------------------------------
# Override the API URL for the frontend
# By default, the frontend uses relative URLs (/api)
# which works both in development (via Vite proxy) and production
# VITE_API_URL=/api

# --------------------------------------------
# GROQ AI API (Required for AI-powered search)
# --------------------------------------------
# Get your API key from: https://console.groq.com/keys
GROQ_API_KEY=your-groq-api-key-here

# --------------------------------------------
# Google Cloud Platform (Required for Production)
# --------------------------------------------
# Used for Google Cloud Tasks (async job processing)
# Required ONLY for Cloud Run deployment, NOT for local development

GCP_PROJECT=sisrua-producao
CLOUD_TASKS_LOCATION=southamerica-east1
CLOUD_TASKS_QUEUE=sisrua-queue

# Auto-populated after Cloud Run deployment
CLOUD_RUN_BASE_URL=http://localhost:8080

# OIDC Authentication for Cloud Tasks Webhook (Production Only)
# The service account that Cloud Tasks uses to authenticate webhook requests
# Format: SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com
# Example: cloud-run-invoker@sisrua-producao.iam.gserviceaccount.com
GCP_SERVICE_ACCOUNT=your-service-account@your-project.iam.gserviceaccount.com

# The full URL of your Cloud Run service (for OIDC audience validation)
# This should match the URL where your service is deployed
# Example: https://sisrua-app-abc123-uc.a.run.app
CLOUD_RUN_SERVICE_URL=https://your-service-name.run.app

# --------------------------------------------
# Firestore (Storage with Circuit Breaker)
# --------------------------------------------
# Enable Firestore for persistent storage with quota monitoring
# In production, Firestore is automatically enabled (NODE_ENV=production)
# In development, set this to 'true' to test Firestore locally
USE_FIRESTORE=false

# Firestore will automatically:
# - Monitor quotas in real-time (reads, writes, deletes, storage)
# - Trigger circuit breaker at 95% of quota
# - Auto-cleanup at 80% of storage (deletes oldest data first)
# - Fallback to memory if circuit breaker opens

# Firestore Quotas (Free Tier):
# - Storage: 1 GiB
# - Reads: 50,000/day
# - Writes: 20,000/day  
# - Deletes: 20,000/day

# Monitor quota usage via: GET /api/firestore/status

# --------------------------------------------
# DXF File Management
# --------------------------------------------
# Time-to-live for generated DXF files (in milliseconds)
# Default: 1 hour (3600000ms) in production, 10 minutes (600000ms) in development
# After this time, files are automatically deleted to free up storage
# Increase if users need more time to download files
# DXF_TTL_MS=3600000

# --------------------------------------------
# Notes for Local Development
# --------------------------------------------
# 1. You only need GROQ_API_KEY for AI search features
# 2. GCP variables are optional for local development
# 3. Docker Compose will use default values if not set
# 4. Redis is NOT required (Cloud Tasks handles job queue in production)
